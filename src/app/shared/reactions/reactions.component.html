<div class="reactions" [class.compact]="compact">
  <ng-container *ngFor="let r of visible; trackBy: trackByEmoji">
    <button
      type="button"
      class="chip"
      [class.me]="r.byMe"
      (click)="toggle(r.emoji)"
      (mouseenter)="showHint(r.emoji)"
      (mouseleave)="hideHint()"
      [attr.aria-pressed]="r.byMe"
      [attr.aria-label]="r.emoji + ': ' + r.count + ' Reaktionen'"
    >
      <span class="emoji" *ngIf="r.emoji !== '✓'">{{ r.emoji }}</span>
      <img *ngIf="r.emoji === '✓'" src="/assets/img/checkMark.svg" alt="✓" class="emoji-svg">
      <span class="count">{{ r.count }}</span>

      <div class="hint" *ngIf="hintEmoji === r.emoji">
        <div class="hint-emoji" *ngIf="r.emoji !== '✓'">{{ r.emoji }}</div>
        <img *ngIf="r.emoji === '✓'" src="/assets/img/checkMark.svg" alt="✓" class="hint-emoji-svg">
        <div class="hint-title">{{ hintTitle(r.emoji) }}</div>
        <div class="hint-sub">{{ hintSubtitle(r.emoji) }}</div>
      </div>
    </button>
  </ng-container>

  <button
    *ngIf="hiddenCount > 0"
    type="button"
    class="chip ghost"
    (click)="expanded = true"
  >
    +{{ hiddenCount }} weitere
  </button>

  <button
    *ngIf="expanded && all.length > baseLimit"
    type="button"
    class="chip ghost"
    (click)="expanded = false"
  >
    Weniger anzeigen
  </button>

  <button type="button" class="chip add" (click)="openPicker()">
    <span class="icon-add" aria-hidden="true"></span>
  </button>
  <div [ngClass]="{'own-message-picker': isOwnMessage, 'not-own-message-picker': notOwnMessage}" class="picker" *ngIf="pickerOpen" (mouseleave)="pickerOpen = false">
    <button *ngFor="let e of quickEmojis" (click)="add(e)">
      <span *ngIf="e !== '✓'">{{ e }}</span>
      <img *ngIf="e === '✓'" src="/assets/img/checkMark.svg" alt="✓" class="picker-emoji-svg">
    </button>
  </div>
</div>
